<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
<!-- modal -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- Latest compiled and minified JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
 
<!-- jQuery -->
<!-- Popper.js -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>

    <!-- modal -->
    <!-- jQuery -->
    <!-- <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> -->

<!-- Popper.js -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script> -->

<!-- Bootstrap JavaScript -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script> -->

    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous"> -->
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script> -->
    <style>
        .table-title {
            text-align: center;
        }
        h2 {
            font-weight: 400;
        }
        .errmsg {
            color: rgba(255, 0, 0, 0.582);
            font-size: 16px;
        }
    .notify {
        width: 100%;
        background-color: #99FF99;
        color: #1d2630;
        padding: 10px;
        border-radius: 10px;
        /* height: 30px; */
        display: none;
        font-size: 18px;
    }

    span {
        font-size: 30px;
    }
    #table-body td{
        /* color: black; */
        background-color:#1d2630;
    }

    #form {
        display: flex;
        flex-direction: column;
        justify-content: end;
    }
    </style>
</head>
<body style="color: white; background-color: #1d2630;">
<!-- modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">Confirm Deletion</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="color: black; font-size: 20px;">
                Are you sure you want to delete this entry?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn" >Delete</button>
            </div>
        </div>
    </div>
</div>
<!-- modal -->

    <div class="container mt-5" >
        <div class="text-center">
            <h1 class="display-5 mb-5"><strong>CRUD Application <span>(with jquery)</span></strong></h1>
        </div>
        <div class="notify" id="notify">

        </div><br> <br>
        <div class="main row justify-content-center">
            <form action="" id="form" class="row justify-content-center mb-4" autocomplete="off">
                <div class="col-10 col-md-8 mb-3">
                    <label for="firstName">First Name</label>
                    <input class="form-control" id="firstName" type="text" placeholder="Enter First Name">
                    <div class="errmsg" id="err-name" style="display: none;"></div>
                </div>
                <div class="col-10 col-md-8 mb-3">
                    <label for="lastName">Last Name</label>
                    <input class="form-control" id="lastName" type="text" placeholder="Enter last Name">
                    <div class="errmsg" id="err-lastname" style="display: none;">Please Enter Last Name</div>
                </div>
                <div class="col-10 col-md-8 mb-3">
                    <label for="phonenumber">Phone Number</label>
                    <input class="form-control" id="phonenumber" type="number" placeholder="Enter phone number">
                    <div class="errmsg" id="err-number" style="display: none;"></div>
                </div>
                <div class="col-10 col-md-8 col-md-8 mb-3">
                    <label for="email">Email</label>
                    <input class="form-control" id="email" type="text" placeholder="Enter email">
                    <div class="errmsg" id="err-mail" style="display: none;"></div>
                </div>
                <div class="col-10 col-md-8">
                    <!-- <input class="btn btn-success add-btn" type="submit" value="submit" id="btn"> -->
                    <br><button  class="btn btn-success add-btn" type="submit" id="submit-btn" style="display: block;">Submit</button>
                    <button class=" btn btn-success add-btn" type="submit" id="update-btn" style="display: none;margin-right: 25px;">Update</button>
                    <button class="btn btn-danger bt dangerr" type="button" id="cancel-btn" style="display: none;" onclick="cancel()">Cancel</button>
                </div> 
            </form> <br> <br> <br>
            <div class="col-12  mt-5">
                <table class="table table-striped table-dark">
                    <thead>
                        <tr>
                            <th>First Name</th>
                            <th>Last Name</th>
                            <th>Phone Number</th>
                            <th>Email ID</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <tr>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <script>
        const items = [];
        let editingIndex = -1;

        $(document).ready(function () {
            $('#form').submit(function (e) {
                e.preventDefault();

                const name = $('#firstName').val();
                const lastname = $('#lastName').val();
                const phone = $('#phonenumber').val();
                const email = $('#email').val();

                if(name == "" || name == null){
                    $('#err-name').show().text('invalid name');
                    return;
                }
                else {
                    $('#err-name').hide();
                }
                if(lastname.trim() == "" || lastname ==null){
                    $('#err-lastname').show();
                    return;
                }
                else{
                    $('#err-lastname').hide();
                }
                if(phone.length == null || phone.length <1){
                    $('#err-number').show().text("phone number can't be blank");
                    return;
                }
                else{
                    $('#err-number').hide();
                }
                if(phone.length <10){
                    $('#err-number').show().text("phone number can't be less than 10");
                    return;
                }
                else{
                    $('#err-number').hide();
                }
                if(phone.length >10){
                    $('#err-number').show().text("phone number can't be greater than 10");
                    return;
                }
                else{
                    $('#err-number').hide();
                }
                if(isValidEmail(email)){
                    $('#err-mail').hide();
                }
                else{
                    $('#err-mail').show().text("Invalid email");
                    return;
                }

                if (editingIndex == -1) {
                    if (items.some(item => item.name == name)) {
                        $('#err-name').text('Name Already Exists');
                        $('#err-name').show();
                        return;
                    } else {
                        const newItem = { name, lastname, phone, email };
                        items.push(newItem);
                        $('#notify').show().text('Submitted').css('background-color', '#99FF99');
                    }
                } else {
                    // Edit existing item in the items array
                    const editedItem = items[editingIndex];
                    editedItem.name = name;
                    editedItem.lastname = lastname;
                    editedItem.phone = phone;
                    editedItem.email = email;
                    $('#update-btn, #cancel-btn').hide();
                    $('#submit-btn').show();
                    $('#notify').show().text('Updated').css('background-color', '#99FF99');
                    editingIndex = -1;
                }
                
                updateTable();
                $('#form')[0].reset();
            });

        });

        function updateTable() {
            const tableBody = $('#table-body');
            tableBody.empty();

            if (items.length === 0) {
                const noRecords = $('<tr><td colspan="5" class="table-title"><h2>No Records Entered Yet</h2></td></tr>');
                tableBody.append(noRecords);
            } else {
                items.forEach((item, index) => {
                    const row = $('<tr><td>' + item.name + '</td><td>' + item.lastname + '</td><td>' + item.phone + '</td><td>' + item.email + '</td><td><button class="btn btn-warning btn-sm edit" onClick="edit(' + index + ')">Edit</button> <button class="btn btn-danger btn-sm danger" data-toggle="modal" data-target="#deleteModal" data-index="INDEX">Delete</button></td></tr>');
                    tableBody.append(row);
                });
            }
        }

        function edit(index) {
            const editedItem = items[index];
            editingIndex = index;

            $('#firstName').val(editedItem.name);
            $('#lastName').val(editedItem.lastname);
            $('#phonenumber').val(editedItem.phone);
            $('#email').val(editedItem.email);

            $('#update-btn, #cancel-btn').show();
            $('#submit-btn').hide();
        }

        function deleteItem(index) {
            items.splice(index, 1);
            $('#notify').show().text('Deleted').css('background-color', '#FF6666');
            updateTable();
        }

        $('.btn-danger.danger').click(function () {
        const index = $(this).data('index'); // Get the index from the data attribute
        $('#confirmDeleteBtn').data('index', index); // Store the index in the "Delete" button

        // Show the deletion confirmation modal
        $('#deleteModal').modal('show');
        });
        $('#confirmDeleteBtn').click(function () {
        const index = $(this).data('index');
        deleteItem(index);

        // Close the deletion confirmation modal
        $('#deleteModal').modal('hide');
    });

        function cancel() {
            $('#update-btn, #cancel-btn').hide();
            $('#submit-btn').show();
            $('#form')[0].reset();
            editingIndex =-1;
        }

        function isValidEmail(Email) {
            var emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(Email);
        }

        updateTable();
    </script>

</body>
</html>